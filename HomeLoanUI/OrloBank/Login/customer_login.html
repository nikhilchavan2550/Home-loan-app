<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login – Orlo Bank</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-blue-50 font-sans text-blue-950">

  <header class="bg-sky-100 shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold text-sky-800">Orlo Bank</h1>
      <div class="space-x-4">
        <a href="../index.html" class="text-sky-700 hover:text-sky-900">Features</a>
        <a href="login.html" class="bg-sky-700 text-white px-4 py-2 rounded-full text-sm hover:bg-sky-800">Login</a>
        <a href="../Register/create_account.html" class="text-sky-700 hover:text-sky-900">Open Account</a>
      </div>
    </div>
  </header>

  <section class="py-20 bg-sky-50">
    <div class="max-w-md mx-auto bg-white shadow-md rounded-xl p-8">
      <h2 class="text-3xl font-semibold text-sky-900 mb-6 text-center">Login to Orlo Bank</h2>

      <form id="loginForm" class="space-y-4">
        <div>
          <label class="block font-medium">Customer ID</label>
          <input type="text" id="custId" required class="w-full px-4 py-2 border rounded-md" placeholder="Enter your customer ID"/>
        </div>
        <div>
          <label class="block font-medium">Password</label>
          <input type="password" id="password" required class="w-full px-4 py-2 border rounded-md" placeholder="Enter your password"/>
        </div>
        <button type="submit" class="w-full bg-sky-700 text-white py-3 rounded-full hover:bg-sky-800">Login</button>
      </form>

      <div id="responseMessage" class="mt-6 text-center font-medium hidden"></div>
      <div id="loadingMessage" class="hidden mt-8 text-center">
  <div class="flex items-center justify-center space-x-3">
    <svg class="animate-spin h-6 w-6 text-sky-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor"
        d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z">
      </path>
    </svg>
    <p class="text-sky-800 font-semibold text-lg">Logging In...</p>
  </div>
</div>    </div>
  </section>

  <footer class="bg-sky-100 py-8 text-center text-sm text-sky-700">
    <div class="max-w-6xl mx-auto px-6">
      <div class="mb-4">© 2025 Orlo Bank. All rights reserved.</div>
      <div class="space-x-4">
        <a href="#" class="hover:underline">Privacy Policy</a>
        <a href="#" class="hover:underline">Terms of Use</a>
        <a href="#" class="hover:underline">Support</a>
      </div>
    </div>
  </footer>

  <script>
  const custId = localStorage.getItem("custId");

  if (custId) {
    window.location.href = "../Dashboard/dashboard.html";
  }
    
    $(document).ready(function () {
  $("#loginForm").on("submit", function (e) {
    e.preventDefault();

    const loginData = {
      custId: $("#custId").val(),
      password: $("#password").val()
    };

    $("#loadingMessage").removeClass("hidden");
    $("#loginForm button").prop("disabled", true); 

    $.ajax({
      url: "http://localhost:8084/api/bank/login",
      method: "POST",
      contentType: "application/json",
      data: JSON.stringify(loginData),
      success: function (response) {
        localStorage.setItem("custId", loginData.custId);

        setTimeout(() => {
          window.location.href = "../Dashboard/dashboard.html";
        }, 1500);
      },
      error: function (xhr) {
        const errorMsg = xhr.responseText || "❌ Login failed.";

        $("#loadingMessage").addClass("hidden");
        $("#loginForm button").prop("disabled", false);

        $("#responseMessage")
          .text(errorMsg)
          .removeClass("hidden text-green-600")
          .addClass("text-red-600");
      }
    });
  });
});


    
  </script>

</body>
</html>
